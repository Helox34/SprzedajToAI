<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Gemini AI</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; background-color: #1e1e1e; color: white; }
        textarea { width: 100%; height: 100px; margin-bottom: 10px; padding: 10px; border-radius: 5px; border: none; }
        button { padding: 10px 20px; cursor: pointer; background-color: #ff0055; color: white; border: none; border-radius: 5px; font-weight: bold; }
        #output { margin-top: 20px; white-space: pre-wrap; background: #333; padding: 15px; border-radius: 5px; min-height: 50px;}
    </style>
</head>
<body>

    <h2>Test połączenia z Gemini</h2>
    <p>Wpisz zapytanie poniżej:</p>
    
    <textarea id="promptInput">Opowiedz żart o programistach.</textarea>
    <br>
    <button id="generateBtn">Wyślij do AI</button>

    <div id="output">Tutaj pojawi się odpowiedź...</div>

    <script type="importmap">
      {
        "imports": {
          "@google/generative-ai": "https://esm.run/@google/generative-ai"
        }
      }
    </script>

    <script type="module">
      import { GoogleGenerativeAI } from "@google/generative-ai";

      // Twój klucz API (skopiowany ze zrzutu ekranu)
      const API_KEY = "AIzaSyAHfGqaLponlZfBGooFFcn-Lqs4ALmaxXs";

      // Konfiguracja modelu
      const genAI = new GoogleGenerativeAI(API_KEY);
      const model = genAI.getGenerativeModel({ model: "gemini-pro" });

      const outputElement = document.getElementById('output');
      const btn = document.getElementById('generateBtn');

      btn.addEventListener('click', async () => {
          const prompt = document.getElementById('promptInput').value;
          
          if (!prompt) return;

          outputElement.innerText = "Myślę...";
          btn.disabled = true; // Blokada przycisku na czas generowania

          try {
              // Wywołanie API
              const result = await model.generateContent(prompt);
              const response = await result.response;
              const text = response.text();
              
              // Wyświetlenie wyniku
              outputElement.innerText = text;
          } catch (error) {
              console.error("Błąd szczegółowy:", error);
              outputElement.innerText = "BŁĄD: " + error.message;
              
              if (error.message.includes("403")) {
                  alert("Błąd 403: Sprawdź w Google Cloud Console -> 'Dane uwierzytelniające' -> Twój klucz -> Ograniczenia aplikacji. Ustaw na 'Brak' (None).");
              }
          } finally {
              btn.disabled = false;
          }
      });
    </script>
</body>
</html>